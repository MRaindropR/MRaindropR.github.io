<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>角色属性计算器</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft YaHei", Arial, sans-serif;
        }
        
        body {
            padding: 10px;
            background-color: #f5f5f5;
        }
        
        .calculator-container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 10px;
        }
        
        h1 {
            text-align: center;
            margin: 10px 0;
            color: #333;
            font-size: 1.5rem;
        }
        
        .calculator-table {
            width: 100%;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 4px;
            text-align: center;
            font-size: 0.8rem;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 3px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
            font-size: 0.8rem;
        }
        
        select {
            width: 100%;
            padding: 3px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
            font-size: 0.8rem;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .attribute-name {
            background-color: #e8eaf6;
            font-weight: bold;
            position: sticky;
            left: 0;
            z-index: 2;
        }
        
        /* 表头分类颜色 */
        .section-base {
            background-color: #bbdefb;
        }
        
        .section-basic {
            background-color: #c8e6c9;
        }
        
        .section-ench-percent {
            background-color: #ffcdd2;
        }
        
        .section-ench-fixed {
            background-color: #ffe0b2;
        }
        
        .section-ench-level {
            background-color: #e1bee7;
        }
        
        .section-ench-type {
            background-color: #d1c4e9;
        }
        
        .section-artifacts {
            background-color: #b2dfdb;
        }
        
        .section-equip-skill {
            background-color: #f8bbd0;
        }
        
        .section-ultra {
            background-color: #cfd8dc;
        }
        
        .section-talent {
            background-color: #dcedc8;
        }
        
        .calculate-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 15px auto;
            padding: 10px 15px;
            background-color: #1976d2;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .calculate-btn:hover {
            background-color: #1565c0;
        }
        
        .results-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #1976d2;
        }
        
        .results-title {
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 1.2rem;
            color: #1976d2;
            text-align: center;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        
        .results-table th, .results-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .results-table th {
            background-color: #1976d2;
            color: white;
        }
        
        .results-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .copyright {
            text-align: center;
            margin-top: 20px;
            font-size: 0.8rem;
            color: #666;
            padding: 10px 0;
            border-top: 1px solid #eee;
        }
        
        /* 响应式布局 */
        @media only screen and (max-width: 768px) {
            .calculator-table {
                overflow-x: auto;
            }
            
            th, td {
                padding: 3px 2px;
                font-size: 0.7rem;
            }
            
            input[type="number"] {
                padding: 2px;
                font-size: 0.7rem;
            }
            
            /* 改进的结果表格响应式布局 */
            .results-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin-top: 15px;
            }
            
            .result-card {
                background-color: white;
                border-radius: 5px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                padding: 10px;
                text-align: center;
            }
            
            .result-attribute {
                font-weight: bold;
                font-size: 0.9rem;
                margin-bottom: 5px;
                color: #1976d2;
            }
            
            .result-values {
                display: flex;
                justify-content: space-between;
                margin-top: 8px;
            }
            
            .result-value-label {
                font-size: 0.7rem;
                color: #666;
            }
            
            .result-value {
                font-size: 0.9rem;
                font-weight: bold;
            }
            
            .result-panel {
                background-color: #e8f5e9;
                border-radius: 4px;
                padding: 5px;
                margin-top: 8px;
                font-weight: bold;
                font-size: 1.1rem;
                color: #2e7d32;
            }
            
            /* 隐藏表格，显示卡片布局 */
            .results-table-container {
                display: block;
            }
            
            .results-grid-container {
                display: none;
            }
        }
        
        @media only screen and (max-width: 480px) {
            /* 在小屏幕上隐藏表格，显示卡片布局 */
            .results-table-container {
                display: none;
            }
            
            .results-grid-container {
                display: block;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <h1>角色属性计算器</h1>
        
        <div class="calculator-table">
            <table>
                <thead>
                    <tr>
                        <th rowspan="2">属性</th>
                        <th class="section-base">面板属性</th>
                        <th colspan="4" class="section-basic">基础</th>
                        <th colspan="4" class="section-ench-percent">附魔百分比</th>
                        <th colspan="4" class="section-ench-fixed">附魔固定</th>
                        <th colspan="1" class="section-ench-level">附魔水平</th>
                        <th colspan="1" class="section-ench-type">附魔类型</th>
                        <th colspan="4" class="section-artifacts">神器及精通</th>
                        <th colspan="4" class="section-equip-skill">装备技能</th>
                        <th colspan="1" class="section-ultra">超绝</th>
                        <th colspan="1" class="section-talent">天赋/满月</th>
                    </tr>
                    <tr>
                        <th>白字</th>
                        <th>武器</th>
                        <th>衣服</th>
                        <th>头套</th>
                        <th>饰品</th>
                        <th>武器%</th>
                        <th>衣服%</th>
                        <th>头套%</th>
                        <th>饰品%</th>
                        <th>武器</th>
                        <th>衣服</th>
                        <th>头套</th>
                        <th>饰品</th>
                        <th>综合%</th>
                        <th>红黄蓝绿%</th>
                        <th>神器</th>
                        <th>精通</th>
                        <th>铸纹</th>
                        <th>竞技精通</th>
                        <th>武器</th>
                        <th>衣服</th>
                        <th>头盔</th>
                        <th>饰品</th>
                        <th>职业技能%</th>
                        <th>天赋/寄附%</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="attribute-name">生命</td>
                        <td><input type="number" id="life-base" value="4484" min="0"></td>
                        <td><input type="number" id="life-weapon" value="364" min="0"></td>
                        <td><input type="number" id="life-clothes" value="487" min="0"></td>
                        <td><input type="number" id="life-hat" value="583" min="0"></td>
                        <td><input type="number" id="life-accessory" value="0" min="0"></td>
                        <td><input type="number" id="life-weapon-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="life-clothes-percent" value="10" min="0" max="15"></td>
                        <td><input type="number" id="life-hat-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="life-accessory-percent" value="7" min="0" max="10"></td>
                        <td><input type="number" id="life-weapon-add" value="80" min="0"></td>
                        <td><input type="number" id="life-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="life-hat-add" value="100" min="0"></td>
                        <td><input type="number" id="life-accessory-add" value="0" min="0"></td>
                        <td><span id="life-combine-percent">17.0%</span></td>
                        <td><select id="life-rgb">
                            <option value="0">0%</option>
                            <option value="5">5%</option>
                            <option value="10" selected>10%</option>
                        </select></td>
                        <td><input type="number" id="life-artifact" value="40" min="0"></td>
                        <td><input type="number" id="life-mastery" value="5" min="0"></td>
                        <td><input type="number" id="life-inscription" value="0" min="0"></td>
                        <td><input type="number" id="life-compete" value="0" min="0"></td>
                        <td><input type="number" id="life-weapon-skill" value="0" min="0"></td>
                        <td><input type="number" id="life-clothes-skill" value="5" min="0"></td>
                        <td><input type="number" id="life-hat-skill" value="0" min="0"></td>
                        <td><input type="number" id="life-accessory-skill" value="0" min="0"></td>
                        <td><input type="number" id="life-skill" value="40" min="0"></td>
                        <td><input type="number" id="life-talent" value="10" min="0"></td>
                    </tr>
                    <tr>
                        <td class="attribute-name">攻击</td>
                        <td><input type="number" id="attack-base" value="500" min="0"></td>
                        <td><input type="number" id="attack-weapon" value="118" min="0"></td>
                        <td><input type="number" id="attack-clothes" value="0" min="0"></td>
                        <td><input type="number" id="attack-hat" value="0" min="0"></td>
                        <td><input type="number" id="attack-accessory" value="0" min="0"></td>
                        <td><input type="number" id="attack-weapon-percent" value="15" min="0" max="15"></td>
                        <td><input type="number" id="attack-clothes-percent" value="4" min="0" max="15"></td>
                        <td><input type="number" id="attack-hat-percent" value="3" min="0" max="15"></td>
                        <td><input type="number" id="attack-accessory-percent" value="7" min="0" max="10"></td>
                        <td><input type="number" id="attack-weapon-add" value="0" min="0"></td>
                        <td><input type="number" id="attack-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="attack-hat-add" value="0" min="0"></td>
                        <td><input type="number" id="attack-accessory-add" value="0" min="0"></td>
                        <td><span id="attack-combine-percent">29.0%</span></td>
                        <td><select id="attack-rgb">
                            <option value="0">0%</option>
                            <option value="5" selected>5%</option>
                            <option value="10">10%</option>
                        </select></td>
                        <td><input type="number" id="attack-artifact" value="20" min="0"></td>
                        <td><input type="number" id="attack-mastery" value="5" min="0"></td>
                        <td><input type="number" id="attack-inscription" value="0" min="0"></td>
                        <td><input type="number" id="attack-compete" value="0" min="0"></td>
                        <td><input type="number" id="attack-weapon-skill" value="5" min="0"></td>
                        <td><input type="number" id="attack-clothes-skill" value="0" min="0"></td>
                        <td><input type="number" id="attack-hat-skill" value="0" min="0"></td>
                        <td><input type="number" id="attack-accessory-skill" value="0" min="0"></td>
                        <td><input type="number" id="attack-skill" value="20" min="0"></td>
                        <td><input type="number" id="attack-talent" value="10" min="0"></td>
                    </tr>
                    <tr>
                        <td class="attribute-name">智力</td>
                        <td><input type="number" id="intel-base" value="196" min="0"></td>
                        <td><input type="number" id="intel-weapon" value="0" min="0"></td>
                        <td><input type="number" id="intel-clothes" value="0" min="0"></td>
                        <td><input type="number" id="intel-hat" value="0" min="0"></td>
                        <td><input type="number" id="intel-accessory" value="0" min="0"></td>
                        <td><input type="number" id="intel-weapon-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="intel-clothes-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="intel-hat-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="intel-accessory-percent" value="0" min="0" max="10"></td>
                        <td><input type="number" id="intel-weapon-add" value="0" min="0"></td>
                        <td><input type="number" id="intel-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="intel-hat-add" value="0" min="0"></td>
                        <td><input type="number" id="intel-accessory-add" value="0" min="0"></td>
                        <td><span id="intel-combine-percent">0.0%</span></td>
                        <td><select id="intel-rgb">
                            <option value="0" selected>0%</option>
                            <option value="5">5%</option>
                            <option value="10">10%</option>
                        </select></td>
                        <td><input type="number" id="intel-artifact" value="20" min="0"></td>
                        <td><input type="number" id="intel-mastery" value="0" min="0"></td>
                        <td><input type="number" id="intel-inscription" value="0" min="0"></td>
                        <td><input type="number" id="intel-compete" value="0" min="0"></td>
                        <td><input type="number" id="intel-weapon-skill" value="0" min="0"></td>
                        <td><input type="number" id="intel-clothes-skill" value="5" min="0"></td>
                        <td><input type="number" id="intel-hat-skill" value="0" min="0"></td>
                        <td><input type="number" id="intel-accessory-skill" value="0" min="0"></td>
                        <td><input type="number" id="intel-skill" value="20" min="0"></td>
                        <td><input type="number" id="intel-talent" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td class="attribute-name">防御</td>
                        <td><input type="number" id="defense-base" value="367" min="0"></td>
                        <td><input type="number" id="defense-weapon" value="0" min="0"></td>
                        <td><input type="number" id="defense-clothes" value="65" min="0"></td>
                        <td><input type="number" id="defense-hat" value="0" min="0"></td>
                        <td><input type="number" id="defense-accessory" value="48" min="0"></td>
                        <td><input type="number" id="defense-weapon-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="defense-clothes-percent" value="15" min="0" max="15"></td>
                        <td><input type="number" id="defense-hat-percent" value="10" min="0" max="15"></td>
                        <td><input type="number" id="defense-accessory-percent" value="7" min="0" max="10"></td>
                        <td><input type="number" id="defense-weapon-add" value="0" min="0"></td>
                        <td><input type="number" id="defense-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="defense-hat-add" value="0" min="0"></td>
                        <td><input type="number" id="defense-accessory-add" value="0" min="0"></td>
                        <td><span id="defense-combine-percent">32.0%</span></td>
                        <td><select id="defense-rgb">
                            <option value="0">0%</option>
                            <option value="5" selected>5%</option>
                            <option value="10">10%</option>
                        </select></td>
                        <td><input type="number" id="defense-artifact" value="20" min="0"></td>
                        <td><input type="number" id="defense-mastery" value="0" min="0"></td>
                        <td><input type="number" id="defense-inscription" value="0" min="0"></td>
                        <td><input type="number" id="defense-compete" value="0" min="0"></td>
                        <td><input type="number" id="defense-weapon-skill" value="0" min="0"></td>
                        <td><input type="number" id="defense-clothes-skill" value="0" min="0"></td>
                        <td><input type="number" id="defense-hat-skill" value="5" min="0"></td>
                        <td><input type="number" id="defense-accessory-skill" value="0" min="0"></td>
                        <td><input type="number" id="defense-skill" value="20" min="0"></td>
                        <td><input type="number" id="defense-talent" value="10" min="0"></td>
                    </tr>
                    <tr>
                        <td class="attribute-name">魔防</td>
                        <td><input type="number" id="mdefense-base" value="200" min="0"></td>
                        <td><input type="number" id="mdefense-weapon" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-clothes" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-hat" value="48" min="0"></td>
                        <td><input type="number" id="mdefense-accessory" value="43" min="0"></td>
                        <td><input type="number" id="mdefense-weapon-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="mdefense-clothes-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="mdefense-hat-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="mdefense-accessory-percent" value="0" min="0" max="10"></td>
                        <td><input type="number" id="mdefense-weapon-add" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-hat-add" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-accessory-add" value="0" min="0"></td>
                        <td><span id="mdefense-combine-percent">0.0%</span></td>
                        <td><select id="mdefense-rgb">
                            <option value="0">0%</option>
                            <option value="5" selected>5%</option>
                            <option value="10">10%</option>
                        </select></td>
                        <td><input type="number" id="mdefense-artifact" value="20" min="0"></td>
                        <td><input type="number" id="mdefense-mastery" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-inscription" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-compete" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-weapon-skill" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-clothes-skill" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-hat-skill" value="0" min="0"></td>
                        <td><input type="number" id="mdefense-accessory-skill" value="5" min="0"></td>
                        <td><input type="number" id="mdefense-skill" value="30" min="0"></td>
                        <td><input type="number" id="mdefense-talent" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td class="attribute-name">技巧</td>
                        <td><input type="number" id="tech-base" value="84" min="0"></td>
                        <td><input type="number" id="tech-weapon" value="0" min="0"></td>
                        <td><input type="number" id="tech-clothes" value="0" min="0"></td>
                        <td><input type="number" id="tech-hat" value="0" min="0"></td>
                        <td><input type="number" id="tech-accessory" value="0" min="0"></td>
                        <td><input type="number" id="tech-weapon-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="tech-clothes-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="tech-hat-percent" value="0" min="0" max="15"></td>
                        <td><input type="number" id="tech-accessory-percent" value="0" min="0" max="10"></td>
                        <td><input type="number" id="tech-weapon-add" value="0" min="0"></td>
                        <td><input type="number" id="tech-clothes-add" value="0" min="0"></td>
                        <td><input type="number" id="tech-hat-add" value="0" min="0"></td>
                        <td><input type="number" id="tech-accessory-add" value="0" min="0"></td>
                        <td><span id="tech-combine-percent">0.0%</span></td>
                        <td><select id="tech-rgb">
                            <option value="0" selected>0%</option>
                            <option value="5">5%</option>
                            <option value="10">10%</option>
                        </select></td>
                        <td><input type="number" id="tech-artifact" value="0" min="0"></td>
                        <td><input type="number" id="tech-mastery" value="0" min="0"></td>
                        <td><input type="number" id="tech-inscription" value="0" min="0"></td>
                        <td><input type="number" id="tech-compete" value="0" min="0"></td>
                        <td><input type="number" id="tech-weapon-skill" value="0" min="0"></td>
                        <td><input type="number" id="tech-clothes-skill" value="0" min="0"></td>
                        <td><input type="number" id="tech-hat-skill" value="0" min="0"></td>
                        <td><input type="number" id="tech-accessory-skill" value="5" min="0"></td>
                        <td><input type="number" id="tech-skill" value="0" min="0"></td>
                        <td><input type="number" id="tech-talent" value="0" min="0"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <button class="calculate-btn" id="calculate-button">计算所有属性</button>
        
        <div class="results-container">
            <div class="results-title">计算结果</div>
            
            <!-- 表格布局 (在较大屏幕上显示) -->
            <div class="results-table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>属性</th>
                            <th>白字</th>
                            <th>绿字</th>
                            <th>战斗面板</th>
                        </tr>
                    </thead>
                    <tbody id="results-tbody">
                        <!-- 结果将通过JavaScript填充 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 卡片布局 (在较小屏幕上显示) -->
            <div class="results-grid-container">
                <div class="results-grid" id="results-grid">
                    <!-- 结果将通过JavaScript填充 -->
                </div>
            </div>
        </div>
        
        <div class="copyright">
            © 无境丶黄昏乐章 版权所有
        </div>
    </div>
    
<script>
// 获取属性的中文名
function getAttributeName(attr) {
    const names = {
        'life': '生命',
        'attack': '攻击',
        'intel': '智力', 
        'defense': '防御',
        'mdefense': '魔防',
        'tech': '技巧'
    };
    return names[attr] || attr;
}

// 计算综合百分比（附魔水平）
function calculateCombinePercent(attr) {
    const base = parseFloat(document.getElementById(`${attr}-base`).value) || 0;
    const weaponPercent = parseFloat(document.getElementById(`${attr}-weapon-percent`).value) || 0;
    const clothesPercent = parseFloat(document.getElementById(`${attr}-clothes-percent`).value) || 0;
    const hatPercent = parseFloat(document.getElementById(`${attr}-hat-percent`).value) || 0;
    const accessoryPercent = parseFloat(document.getElementById(`${attr}-accessory-percent`).value) || 0;
    
    const weaponAdd = parseFloat(document.getElementById(`${attr}-weapon-add`).value) || 0;
    const clothesAdd = parseFloat(document.getElementById(`${attr}-clothes-add`).value) || 0;
    const hatAdd = parseFloat(document.getElementById(`${attr}-hat-add`).value) || 0;
    const accessoryAdd = parseFloat(document.getElementById(`${attr}-accessory-add`).value) || 0;
    
    // 附魔水平下的综合 = 附魔百分比之和 + 附魔固定值之和/基础值
    let combinePercent = weaponPercent + clothesPercent + hatPercent + accessoryPercent;
    
    if (base > 0) {
        combinePercent += (weaponAdd + clothesAdd + hatAdd + accessoryAdd) / base * 100;
    }
    
    document.getElementById(`${attr}-combine-percent`).innerText = combinePercent.toFixed(1) + '%';
}

// 计算绿字值
function calculateGreenValue(attr) {
    // 获取所有输入值
    const base = parseFloat(document.getElementById(`${attr}-base`).value) || 0;
    const weapon = parseFloat(document.getElementById(`${attr}-weapon`).value) || 0;
    const clothes = parseFloat(document.getElementById(`${attr}-clothes`).value) || 0;
    const hat = parseFloat(document.getElementById(`${attr}-hat`).value) || 0;
    const accessory = parseFloat(document.getElementById(`${attr}-accessory`).value) || 0;
    
    const weaponPercent = parseFloat(document.getElementById(`${attr}-weapon-percent`).value) || 0;
    const clothesPercent = parseFloat(document.getElementById(`${attr}-clothes-percent`).value) || 0;
    const hatPercent = parseFloat(document.getElementById(`${attr}-hat-percent`).value) || 0;
    const accessoryPercent = parseFloat(document.getElementById(`${attr}-accessory-percent`).value) || 0;
    
    const weaponAdd = parseFloat(document.getElementById(`${attr}-weapon-add`).value) || 0;
    const clothesAdd = parseFloat(document.getElementById(`${attr}-clothes-add`).value) || 0;
    const hatAdd = parseFloat(document.getElementById(`${attr}-hat-add`).value) || 0;
    const accessoryAdd = parseFloat(document.getElementById(`${attr}-accessory-add`).value) || 0;
    
    // 红黄蓝绿百分比
    const rgbPercent = parseFloat(document.getElementById(`${attr}-rgb`).value) || 0;
    
    // 神器和精通
    const artifact = parseFloat(document.getElementById(`${attr}-artifact`).value) || 0;
    const mastery = parseFloat(document.getElementById(`${attr}-mastery`).value) || 0;
    const inscription = parseFloat(document.getElementById(`${attr}-inscription`).value) || 0;
    
    // 绿字 = 基础 + 白字*附魔百分比 + 附魔固定 + 白字*附魔类型 + 神器 + 精通 + 铸纹
    const basicItems = weapon + clothes + hat + accessory;
    const enchantPercent = base * (weaponPercent + clothesPercent + hatPercent + accessoryPercent) / 100;
    const enchantFixed = weaponAdd + clothesAdd + hatAdd + accessoryAdd;
    const enchantType = base * rgbPercent / 100;
    
    const greenValue = basicItems + enchantPercent + enchantFixed + enchantType + artifact + mastery + inscription;
    
    return Math.round(greenValue);
}

// 计算面板值
function calculatePanelValue(attr, greenValue) {
    // 获取所有输入值
    const base = parseFloat(document.getElementById(`${attr}-base`).value) || 0;
    
    // 竞技精通
    const compete = parseFloat(document.getElementById(`${attr}-compete`).value) || 0;
    
    // 装备技能
    const weaponSkill = parseFloat(document.getElementById(`${attr}-weapon-skill`).value) || 0;
    const clothesSkill = parseFloat(document.getElementById(`${attr}-clothes-skill`).value) || 0;
    const hatSkill = parseFloat(document.getElementById(`${attr}-hat-skill`).value) || 0;
    const accessorySkill = parseFloat(document.getElementById(`${attr}-accessory-skill`).value) || 0;
    
    const skill = parseFloat(document.getElementById(`${attr}-skill`).value) || 0;
    const talent = parseFloat(document.getElementById(`${attr}-talent`).value) || 0;
    
    // 进图属性 = (白字+绿字)*(1+超绝+天赋/满月+装备技能) + 竞技精通
    const equipSkillTotal = weaponSkill + clothesSkill + hatSkill + accessorySkill;
    const panelValue = (base + greenValue) * (1 + (skill + talent + equipSkillTotal) / 100) + compete;
    
    return Math.round(panelValue);
}

// 计算所有属性
function calculateAll() {
    const attributes = ['life', 'attack', 'intel', 'defense', 'mdefense', 'tech'];
    let resultsHTML = '';
    let resultsGridHTML = '';
    
    for (const attr of attributes) {
        // 计算综合百分比
        calculateCombinePercent(attr);
        
        // 计算绿字值
        const greenValue = calculateGreenValue(attr);
        
        // 计算面板值
        const panelValue = calculatePanelValue(attr, greenValue);
        const baseValue = document.getElementById(`${attr}-base`).value;
        
        // 为表格添加行
        resultsHTML += `
        <tr>
            <td>${getAttributeName(attr)}</td>
            <td>${baseValue}</td>
            <td>${greenValue}</td>
            <td>${panelValue}</td>
        </tr>`;
        
        // 为网格添加卡片
        resultsGridHTML += `
        <div class="result-card">
            <div class="result-attribute">${getAttributeName(attr)}</div>
            <div class="result-values">
                <div>
                    <div class="result-value-label">白字</div>
                    <div class="result-value">${baseValue}</div>
                </div>
                <div>
                    <div class="result-value-label">绿字</div>
                    <div class="result-value">${greenValue}</div>
                </div>
            </div>
            <div class="result-panel">${panelValue}</div>
        </div>`;
    }
    
    // 更新两个结果显示区域
    document.getElementById('results-tbody').innerHTML = resultsHTML;
    document.getElementById('results-grid').innerHTML = resultsGridHTML;
}

// 为所有输入字段添加事件监听器
window.onload = function() {
    // 初始计算
    calculateAll();
    
    // 绑定计算按钮点击事件
    document.getElementById('calculate-button').addEventListener('click', function() {
        calculateAll();
    });
    
    // 为所有输入框添加变化监听
    document.querySelectorAll('input[type="number"]').forEach(input => {
        input.addEventListener('input', function() {
            if (parseFloat(this.value) < 0) {
                this.value = 0;
            }
            
            // 如果是饰品附魔百分比字段且大于10%，限制为10%
            if (this.id.includes('accessory-percent') && parseFloat(this.value) > 10) {
                this.value = 10;
            }
            // 如果是其他附魔百分比字段且大于15%，限制为15%
            else if (this.id.includes('-percent') && !this.id.includes('accessory-percent') && !this.id.includes('combine-percent') && parseFloat(this.value) > 15) {
                this.value = 15;
            }
            
            // 输入变化时自动重新计算
            calculateAll();
        });
    });
    
    // 为下拉选择框添加变化监听
    document.querySelectorAll('select').forEach(select => {
        select.addEventListener('change', function() {
            calculateAll();
        });
    });
    
    // 检测设备宽度，根据屏幕大小调整显示
    function checkScreenSize() {
        const resultsTableContainer = document.querySelector('.results-table-container');
        const resultsGridContainer = document.querySelector('.results-grid-container');
        
        if (window.innerWidth <= 480) {
            resultsTableContainer.style.display = 'none';
            resultsGridContainer.style.display = 'block';
        } else {
            resultsTableContainer.style.display = 'block';
            resultsGridContainer.style.display = 'none';
        }
    }
    
    // 初始检查屏幕大小
    checkScreenSize();
    
    // 当窗口大小改变时重新检查
    window.addEventListener('resize', checkScreenSize);
};
</script>